{% extends "base.html" %}

{% block title %}Book Unavailable{% endblock %}

{% block content %}
<div class="lending-page">
  <div class="auth-card lending-card">
    <div class="auth-header">
      <img src="{{ url_for('static', filename='img/logo.png') }}" alt="Library crest" class="auth-cross-logo">
      <h1 class="auth-title lending-title">{{ book.title }}</h1>
      <p class="auth-subtitle">by {{ book.author }}</p>
    </div>

    <div class="warning-box">
      <p>
        All {{ book.owned_copies }} {% if book.owned_copies == 1 %}copy is{% else %}copies are{% endif %}
        currently on loan.
        {% if waitlist_position > 0 %}
        There {% if waitlist_position == 1 %}is 1 patron{% else %}are {{ waitlist_position }} patrons{% endif %} on the waitlist.
        {% endif %}
      </p>
    </div>

    <p class="text-muted">
      Join the waitlist to be notified when a copy becomes available.
      Patrons are notified in the order they joined.
    </p>

    <form method="post" action="{{ url_for('lending.join_waitlist', book_public_id=book.public_id) }}">
      <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
      <button type="submit" class="btn btn-secondary btn-full my-md">
        Join Waitlist
      </button>
    </form>

    <div class="ornament-divider my-lg"></div>

    <p>
      <a href="{{ url_for('catalog.detail', public_id=book.public_id) }}">&larr; Back to book details</a>
    </p>
  </div>
</div>
{% endblock %}
