{% extends "base.html" %}

{% block title %}{{ reading_list.name }}{% endblock %}

{% block content %}
<section class="collection-detail">
  <nav class="collection-nav">
    <a href="{{ url_for('collections.index') }}" class="collection-back-link">&larr; Back to Collections</a>
  </nav>

  <header class="collection-header">
    <h1 class="collection-title">{{ reading_list.name }}</h1>
    {% if reading_list.season %}
      <span class="season-badge">
        {% if reading_list.season == "advent" %}Advent
        {% elif reading_list.season == "christmas" %}Christmastide
        {% elif reading_list.season == "ordinary_early" %}Ordinary Time
        {% elif reading_list.season == "lent" %}Lent
        {% elif reading_list.season == "easter" %}Eastertide
        {% elif reading_list.season == "ordinary_late" %}Ordinary Time
        {% endif %}
      </span>
    {% endif %}
    {% if reading_list.description %}
      <p class="collection-desc">{{ reading_list.description }}</p>
    {% endif %}
    <p class="collection-meta">
      {{ reading_list.items|length }} {{ "book" if reading_list.items|length == 1 else "books" }}
      &middot; Curated by {{ reading_list.creator.display_name }}
    </p>
  </header>

  {% if reading_list.items %}
  <ol class="collection-books">
    {% for item in reading_list.items %}
      <li class="collection-book-item">
        {# Book cover thumbnail #}
        <div class="collection-book-cover">
          {% if item.book.cover_filename %}
            <img src="{{ url_for('catalog.serve_cover', filename=item.book.cover_filename) }}"
                 alt="Cover of {{ item.book.title }}">
          {% else %}
            <div class="collection-book-no-cover">
              <span>No cover</span>
            </div>
          {% endif %}
        </div>

        {# Book details #}
        <div class="collection-book-details">
          <div class="collection-book-header">
            <span class="collection-book-position">{{ item.position }}.</span>
            <a href="{{ url_for('catalog.detail', public_id=item.book.public_id) }}" class="collection-book-link">
              {{ item.book.title }}
            </a>
          </div>
          <p class="collection-book-author">{{ item.book.author }}</p>

          {% if item.note %}
            <p class="collection-book-note">
              {{ item.note }}
            </p>
          {% endif %}

          {% if item.book.description %}
            <p class="collection-book-desc">{{ item.book.description|truncate(200) }}</p>
          {% endif %}

          {# Availability badge #}
          <div class="mt-sm">
            {% if item.book.is_available %}
              <span class="avail-badge avail-badge--yes">Available</span>
            {% else %}
              <span class="avail-badge avail-badge--no">Currently on loan</span>
            {% endif %}
          </div>
        </div>
      </li>
    {% endfor %}
  </ol>
  {% else %}
  <div class="collections-empty">
    <p class="collections-empty-main">This reading list is empty.</p>
  </div>
  {% endif %}
</section>
{% endblock %}
