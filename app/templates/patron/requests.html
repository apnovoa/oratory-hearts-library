{% extends "base.html" %}

{% block title %}My Book Requests - {{ library_name_latin }}{% endblock %}

{% block content %}
<h1 class="page-title">My Book Requests</h1>
<p class="page-subtitle">Track the status of books you have requested.</p>

{% include "patron/_nav.html" %}

<div class="mt-md" style="margin-bottom:1.5rem;">
  <a href="{{ url_for('patron.request_new') }}" class="btn btn-primary">Request a New Book</a>
</div>

{% if requests %}
<div class="table-responsive">
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Title</th>
        <th>Author</th>
        <th>Submitted</th>
        <th>Status</th>
        <th>Librarian Notes</th>
      </tr>
    </thead>
    <tbody>
      {% for req in requests %}
      <tr>
        <td><strong>{{ req.title }}</strong></td>
        <td>{{ req.author or '&mdash;'|safe }}</td>
        <td class="text-sans text-small">{{ req.created_at.strftime('%d %b %Y') }}</td>
        <td>
          {% if req.status == 'pending' %}
            <span class="badge badge--active" style="background:#c5993e; color:#fff;">Pending</span>
          {% elif req.status == 'approved' %}
            <span class="badge badge--returned" style="background:#2a7d4f; color:#fff;">Approved</span>
          {% elif req.status == 'declined' %}
            <span class="badge badge--expired" style="background:#6b1d2a; color:#fff;">Declined</span>
          {% elif req.status == 'fulfilled' %}
            <span class="badge badge--returned" style="background:#1a6b3a; color:#fff;">Fulfilled</span>
          {% else %}
            <span class="badge">{{ req.status|capitalize }}</span>
          {% endif %}
        </td>
        <td class="text-sans text-small">
          {% if req.admin_notes %}
            {{ req.admin_notes }}
          {% else %}
            &mdash;
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% else %}
<div class="empty-state">
  <div class="empty-state-icon" style="font-size:3rem;">&#128220;</div>
  <p class="empty-state-title">No Requests Yet</p>
  <p class="empty-state-text">You have not submitted any book requests.</p>
  <a href="{{ url_for('patron.request_new') }}" class="btn btn-primary">Request a Book</a>
</div>
{% endif %}

{% endblock %}
